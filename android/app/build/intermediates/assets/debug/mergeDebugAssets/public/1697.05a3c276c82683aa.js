"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1697],{1697:(k,f,s)=>{s.r(f),s.d(f,{PerfilAlumnoPageModule:()=>O});var g=s(2200),p=s(4341),a=s(9420),h=s(8132),u=s(467),b=s(8184),t=s(3664),c=s(2615),v=s(5705);const P=(n,d)=>d.id;function C(n,d){if(1&n){const i=t.RV6();t.j41(0,"ion-card",9)(1,"ion-card-content")(2,"div",10)(3,"div",11)(4,"ion-avatar",12),t.nrm(5,"ion-icon",13),t.k0s()(),t.j41(6,"div",14)(7,"h3",15),t.EFF(8),t.k0s()(),t.j41(9,"div",16)(10,"ion-button",17),t.bIt("click",function(){const e=c.eBV(i).$implicit,r=t.XpG(2);return c.Njj(r.abrirRegistroFamiliar(e))}),t.nrm(11,"ion-icon",18),t.k0s(),t.j41(12,"ion-button",19),t.bIt("click",function(){const e=c.eBV(i).$implicit,r=t.XpG(2);return c.Njj(r.eliminarFamiliar(e.id,e.nombre,e.apellido))}),t.nrm(13,"ion-icon",20),t.k0s()()()()()}if(2&n){const i=d.$implicit;t.R7$(8),t.Lme("",i.nombre," ",i.apellido)}}function _(n,d){if(1&n&&(t.j41(0,"div"),t.Z7z(1,C,14,2,"ion-card",9,P),t.k0s()),2&n){const i=t.XpG();t.R7$(),t.Dyx(i.familiares)}}function F(n,d){1&n&&(t.j41(0,"div",7),t.nrm(1,"ion-icon",21),t.j41(2,"h3"),t.EFF(3,"No hay familiares registrados"),t.k0s(),t.j41(4,"p"),t.EFF(5,"Agrega tu primer familiar externo para comenzar"),t.k0s()())}const y=[{path:"",component:(()=>{class n{constructor(i,o,e,r){this.modalCtrl=i,this.alertController=o,this.toastController=e,this.conocidosService=r,this.familiares=[]}ngOnInit(){const i=localStorage.getItem("usuario"),o=i?JSON.parse(i):null;o&&o.id?(this.tutorId=o.id,this.cargarFamiliares()):console.error("No se encontr\xf3 el ID del tutor en localStorage")}cargarFamiliares(){this.conocidosService.getByTutorId(this.tutorId).subscribe({next:i=>this.familiares=i,error:()=>this.mostrarToast("No se pudieron cargar los familiares","danger")})}abrirRegistroFamiliar(i){var o=this;return(0,u.A)(function*(){const e=yield o.modalCtrl.create({component:b.t,componentProps:{familiar:i?{...i}:null}});e.onDidDismiss().then(function(){var r=(0,u.A)(function*({data:m}){if(m?.familiar){const l=m.familiar;if(!l.fotoArchivo&&!l.foto)return void o.mostrarToast("La foto es obligatoria","warning");const A=l.foto?l.foto:yield o.convertirImagenABase64(l.fotoArchivo),x={nombre:l.nombre,apellido:l.apellido,parentesco:l.parentesco,tutorId:o.tutorId,foto:A};i?o.conocidosService.update(i.id,x).subscribe({next:()=>{o.mostrarToast("Familiar actualizado","success"),o.cargarFamiliares()},error:()=>o.mostrarToast("Error al actualizar familiar","danger")}):o.conocidosService.create(x).subscribe({next:()=>{o.mostrarToast("Familiar registrado exitosamente","success"),o.cargarFamiliares()},error:()=>o.mostrarToast("Error al registrar familiar","danger")})}});return function(m){return r.apply(this,arguments)}}()),yield e.present()})()}eliminarFamiliar(i,o,e){var r=this;return(0,u.A)(function*(){yield(yield r.alertController.create({header:"Eliminar Familiar",message:`\xbfEst\xe1s seguro de que quieres eliminar a ${o} ${e}?`,buttons:[{text:"Cancelar",role:"cancel"},{text:"Eliminar",role:"destructive",handler:()=>{r.conocidosService.delete(i).subscribe({next:()=>{r.mostrarToast("Familiar eliminado","success"),r.cargarFamiliares()},error:()=>r.mostrarToast("Error al eliminar familiar","danger")})}}]})).present()})()}mostrarToast(i,o){var e=this;return(0,u.A)(function*(){(yield e.toastController.create({message:i,duration:2e3,color:o,position:"bottom"})).present()})()}convertirImagenABase64(i){return new Promise((o,e)=>{const r=new FileReader;r.readAsDataURL(i),r.onload=()=>o(r.result),r.onerror=m=>e(m)})}static#t=this.\u0275fac=function(o){return new(o||n)(t.rXU(a.W3),t.rXU(a.hG),t.rXU(a.K_),t.rXU(v.b))};static#o=this.\u0275cmp=t.VBU({type:n,selectors:[["app-perfil-alumno"]],decls:16,vars:2,consts:[[3,"translucent"],["color","primary",1,"ion-text-center"],["slot","start"],["defaultHref","/","text",""],["color","light"],["size","small",1,"ion-text-center"],[1,"ion-padding"],[1,"empty-state"],["id","bottone1",3,"click"],[1,"familiar-card"],[1,"familiar-info"],[1,"avatar-section"],[1,"familiar-avatar"],["name","person-circle-outline","size","large"],[1,"info-section"],[1,"familiar-name"],[1,"actions-section"],["fill","clear","color","primary","size","small",3,"click"],["name","create-outline","slot","icon-only"],["fill","clear","color","danger","size","small",3,"click"],["name","trash-outline","slot","icon-only"],["name","people-outline","size","large","color","medium"]],template:function(o,e){1&o&&(t.j41(0,"ion-header",0)(1,"ion-toolbar",1)(2,"ion-title"),t.EFF(3,"CREDENCIAL DIGITAL"),t.k0s(),t.j41(4,"ion-buttons",2),t.nrm(5,"ion-back-button",3),t.k0s()(),t.j41(6,"ion-toolbar",4)(7,"ion-title",5)(8,"ion-card-subtitle"),t.EFF(9,"REGISTRO DE CONOCIDOS"),t.k0s()()()(),t.j41(10,"ion-content",6),t.nVh(11,_,3,0,"div")(12,F,6,0,"div",7),t.j41(13,"button",8),t.bIt("click",function(){return e.abrirRegistroFamiliar()}),t.j41(14,"strong"),t.EFF(15,"Registrar Familiar Externo"),t.k0s()()()),2&o&&(t.Y8G("translucent",!0),t.R7$(11),t.vxM(e.familiares.length>0?11:12))},dependencies:[a.bv,a.mC,a.Jm,a.QW,a.b_,a.I9,a.HW,a.W9,a.eU,a.iq,a.BC,a.ai,a.el,p.YN,g.MD],styles:['@charset "UTF-8";.familiar-card[_ngcontent-%COMP%]{margin-bottom:16px;border-radius:12px;box-shadow:0 2px 8px #0000001a}.familiar-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.avatar-section[_ngcontent-%COMP%]{flex-shrink:0}.familiar-avatar[_ngcontent-%COMP%]{width:60px;height:60px}.info-section[_ngcontent-%COMP%]{flex:1}.familiar-name[_ngcontent-%COMP%]{margin:0 0 8px;font-size:1.2em;font-weight:600;color:var(--ion-color-dark)}.detail-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:4px;font-size:.9em;color:var(--ion-color-medium)}.actions-section[_ngcontent-%COMP%]{flex-shrink:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:60px 20px;color:var(--ion-color-medium)}.empty-state[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{margin-bottom:16px}.empty-state[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-weight:600}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:.9em}.add-button-container[_ngcontent-%COMP%]{position:sticky;bottom:0;background:var(--ion-color-light);padding:16px 0;margin:16px -16px -16px;border-top:1px solid var(--ion-color-light-shade)}.add-familiar-button[_ngcontent-%COMP%]{margin:0 16px}#bottone1[_ngcontent-%COMP%]{padding:16px 33px;border-radius:9px;background:#1b79eb;border:none;font-family:inherit;text-align:center;cursor:pointer;transition:.4s;color:#fff}#bottone1[_ngcontent-%COMP%]:hover{box-shadow:7px 5px 56px -14px #5355e0}#bottone1[_ngcontent-%COMP%]:active{transform:scale(.97);box-shadow:7px 5px 56px -10px #0c1a92}']})}return n})()}];let M=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#o=this.\u0275mod=t.$C({type:n});static#i=this.\u0275inj=c.G2t({imports:[h.iI.forChild(y),h.iI]})}return n})(),O=(()=>{class n{static#t=this.\u0275fac=function(o){return new(o||n)};static#o=this.\u0275mod=t.$C({type:n});static#i=this.\u0275inj=c.G2t({imports:[g.MD,p.YN,a.bv,M]})}return n})()}}]);