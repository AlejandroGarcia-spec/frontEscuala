"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6682],{3817:(b,_,s)=>{s.d(_,{b:()=>u});var c=s(2615),h=s(9330);let u=(()=>{class r{constructor(o){this.http=o,this.apiUrl="https://backescolar-production.up.railway.app/grupos"}obtenerGrupos(){return this.http.get(`${this.apiUrl}/getAll`)}obtenerGrupoPorId(o){return this.http.get(`${this.apiUrl}/${o}`)}crearGrupo(o){return this.http.post(`${this.apiUrl}/post`,o)}actualizarGrupo(o,p){return this.http.patch(`${this.apiUrl}/${o}`,p)}eliminarGrupo(o){return this.http.delete(`${this.apiUrl}/${o}`)}static#t=this.\u0275fac=function(p){return new(p||r)(c.KVO(h.Qq))};static#o=this.\u0275prov=c.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},6682:(b,_,s)=>{s.d(_,{e:()=>R});var c=s(467),h=s(2200),u=s(4341),r=s(9420),t=s(3664),o=s(5032),p=s(3817),A=s(6993),P=s(8816);const F=(l,d)=>d.id;function M(l,d){if(1&l&&(t.j41(0,"ion-select-option",7),t.EFF(1),t.k0s()),2&l){const n=d.$implicit;t.Y8G("value",n.id),t.R7$(),t.SpI(" ",n.nombre," ")}}function I(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"El nombre es requerido y debe tener m\xednimo 2 letras"),t.k0s()())}function $(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"El apellido es requerido y debe tener m\xednimo 2 letras"),t.k0s()())}function C(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"El correo no es v\xe1lido"),t.k0s()())}function U(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"El tel\xe9fono debe tener 10 d\xedgitos"),t.k0s()())}function T(l,d){if(1&l&&(t.j41(0,"ion-select-option",7),t.EFF(1),t.k0s()),2&l){const n=d.$implicit;t.Y8G("value",n.id),t.R7$(),t.SpI(" ",n.nombre," ")}}function k(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"Selecciona un grupo"),t.k0s()())}function D(l,d){if(1&l&&(t.j41(0,"ion-select-option",7),t.EFF(1),t.k0s()),2&l){const n=d.$implicit;t.Y8G("value",n.id),t.R7$(),t.Lme(" ",n.nombre," ",n.apellido," ")}}function y(l,d){1&l&&(t.j41(0,"ion-text",10)(1,"p",19),t.EFF(2,"Selecciona un tutor"),t.k0s()())}function O(l,d){if(1&l&&(t.j41(0,"ion-item"),t.nrm(1,"img",20),t.k0s()),2&l){const n=t.XpG();t.R7$(),t.Y8G("src",n.fotoPreview,t.B4B)}}let R=(()=>{class l{constructor(n,i,e,a,m,g,f){this.fb=n,this.toastController=i,this.modalController=e,this.grupoService=a,this.alumnosService=m,this.tutorService=g,this.navParams=f,this.tutores=[],this.grupos=[],this.alumnos=[],this.fotoPreview=null,this.fotoArchivo=null}ngOnInit(){this.alumnoSeleccionado=this.navParams.get("alumnoSeleccionado"),this.alumnoForm=this.fb.group({id:[null,u.k0.required],nombre:["",[u.k0.required,u.k0.minLength(2)]],apellido:["",[u.k0.required,u.k0.minLength(2)]],correo:["",[u.k0.email]],telefono:["",[u.k0.pattern(/^\d{10}$/)]],grupoId:["",u.k0.required],tutorId:["",u.k0.required]}),this.alumnoSeleccionado&&(this.alumnoForm.patchValue({id:this.alumnoSeleccionado.id,nombre:this.alumnoSeleccionado.nombre,apellido:this.alumnoSeleccionado.apellido,correo:this.alumnoSeleccionado.correo,telefono:this.alumnoSeleccionado.telefono,grupoId:this.alumnoSeleccionado.grupoId,tutorId:this.alumnoSeleccionado.tutorId}),this.fotoPreview=this.alumnoSeleccionado.imagenBase64),this.cargarTutores(),this.cargarGrupos(),this.cargarAlumnos()}cargarTutores(){var i,n=this;this.tutorService.obtenerTutores().subscribe({next:i=>{this.tutores=i},error:(i=(0,c.A)(function*(e){(yield n.toastController.create({message:"Error al cargar tutores",duration:2e3,color:"danger"})).present(),console.error(e)}),function(a){return i.apply(this,arguments)})})}cargarGrupos(){var i,n=this;this.grupoService.obtenerGrupos().subscribe({next:i=>{this.grupos=i},error:(i=(0,c.A)(function*(e){(yield n.toastController.create({message:"Error al cargar grupos",duration:2e3,color:"danger"})).present()}),function(a){return i.apply(this,arguments)})})}cargarAlumnos(){var i,n=this;this.alumnosService.obtenerAlumnos().subscribe({next:i=>{this.alumnos=i},error:(i=(0,c.A)(function*(e){(yield n.toastController.create({message:"Error al cargar alumnos",duration:2e3,color:"danger"})).present()}),function(a){return i.apply(this,arguments)})})}onImageSelected(n){const i=n.target.files[0];if(i){this.fotoArchivo=i;const e=new FileReader;e.onload=()=>{this.fotoPreview=e.result},e.readAsDataURL(i)}}guardarAlumno(){var n=this;return(0,c.A)(function*(){if(n.alumnoForm.valid){const i=n.alumnoForm.value,e={nombre:i.nombre,apellido:i.apellido,correo:i.correo,telefono:i.telefono,grupoId:i.grupoId,tutorId:i.tutorId,imagenBase64:n.fotoPreview?n.fotoPreview.toString():null};n.alumnosService.actualizarAlumno(i.id,e).subscribe({next:(a=(0,c.A)(function*(){(yield n.toastController.create({message:"Alumno actualizado correctamente \u2705",duration:2e3,color:"success"})).present(),n.cerrarModal(!0)}),function(){return a.apply(this,arguments)}),error:function(){var a=(0,c.A)(function*(){(yield n.toastController.create({message:"Error al actualizar alumno",duration:2e3,color:"danger"})).present()});return function(){return a.apply(this,arguments)}}()})}else(yield n.toastController.create({message:"Formulario inv\xe1lido \u274c",duration:2e3,color:"danger"})).present();var a})()}cerrarModal(n=!1){this.modalController.dismiss({actualizado:n})}onAlumnoChange(n){var a,i=this;this.alumnosService.obtenerAlumnoPorId(n.detail.value).subscribe({next:a=>{this.alumnoForm.patchValue({id:a.id,nombre:a.nombre,apellido:a.apellido,correo:a.correo||"",telefono:a.telefono||"",grupoId:a.grupoId}),this.fotoPreview=a.imagenBase64||null},error:(a=(0,c.A)(function*(){(yield i.toastController.create({message:"Error al cargar datos del alumno",duration:2e3,color:"danger"})).present()}),function(){return a.apply(this,arguments)})})}static#t=this.\u0275fac=function(i){return new(i||l)(t.rXU(u.ok),t.rXU(r.K_),t.rXU(r.W3),t.rXU(p.b),t.rXU(A.p),t.rXU(P.c),t.rXU(o.y8))};static#o=this.\u0275cmp=t.VBU({type:l,selectors:[["app-editar-alumno-modal"]],inputs:{alumno:"alumno"},decls:58,vars:9,consts:[["color","primary"],["slot","end"],[3,"click"],["name","close"],[1,"ion-padding"],[3,"ngSubmit","formGroup"],["formControlName","id",3,"ionChange"],[3,"value"],["position","floating"],["formControlName","nombre"],["color","danger"],["formControlName","apellido"],["type","email","formControlName","correo"],["type","tel","formControlName","telefono"],["formControlName","grupoId","placeholder","Selecciona un grupo"],["formControlName","tutorId","placeholder","Selecciona un tutor"],["lines","none"],["type","file","accept","image/*",3,"change"],["expand","full","type","submit",3,"disabled"],[1,"ion-padding-start"],[2,"width","100%","max-height","200px","object-fit","cover",3,"src"]],template:function(i,e){if(1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar",0)(2,"ion-title"),t.EFF(3,"Editar Alumno"),t.k0s(),t.j41(4,"ion-buttons",1)(5,"ion-button",2),t.bIt("click",function(){return e.cerrarModal()}),t.nrm(6,"ion-icon",3),t.k0s()()()(),t.j41(7,"ion-content",4)(8,"form",5),t.bIt("ngSubmit",function(){return e.guardarAlumno()}),t.j41(9,"ion-list")(10,"ion-item")(11,"ion-label"),t.EFF(12,"Seleccionar Alumno"),t.k0s(),t.j41(13,"ion-select",6),t.bIt("ionChange",function(m){return e.onAlumnoChange(m)}),t.Z7z(14,M,2,2,"ion-select-option",7,F),t.k0s()(),t.j41(16,"ion-item")(17,"ion-label",8),t.EFF(18,"Nombre"),t.k0s(),t.nrm(19,"ion-input",9),t.k0s(),t.nVh(20,I,3,0,"ion-text",10),t.j41(21,"ion-item")(22,"ion-label",8),t.EFF(23,"Apellido"),t.k0s(),t.nrm(24,"ion-input",11),t.k0s(),t.nVh(25,$,3,0,"ion-text",10),t.j41(26,"ion-item")(27,"ion-label",8),t.EFF(28,"Correo (opcional)"),t.k0s(),t.nrm(29,"ion-input",12),t.k0s(),t.nVh(30,C,3,0,"ion-text",10),t.j41(31,"ion-item")(32,"ion-label",8),t.EFF(33,"Tel\xe9fono (opcional)"),t.k0s(),t.nrm(34,"ion-input",13),t.k0s(),t.nVh(35,U,3,0,"ion-text",10),t.j41(36,"ion-item")(37,"ion-label"),t.EFF(38,"Grupo"),t.k0s(),t.j41(39,"ion-select",14),t.Z7z(40,T,2,2,"ion-select-option",7,F),t.k0s()(),t.nVh(42,k,3,0,"ion-text",10),t.j41(43,"ion-item")(44,"ion-label"),t.EFF(45,"Tutor"),t.k0s(),t.j41(46,"ion-select",15),t.Z7z(47,D,2,3,"ion-select-option",7,F),t.k0s()(),t.nVh(49,y,3,0,"ion-text",10),t.j41(50,"ion-item",16)(51,"ion-label"),t.EFF(52,"Foto del Alumno"),t.k0s()(),t.j41(53,"ion-item")(54,"input",17),t.bIt("change",function(m){return e.onImageSelected(m)}),t.k0s()(),t.nVh(55,O,2,1,"ion-item"),t.j41(56,"ion-button",18),t.EFF(57," Guardar "),t.k0s()()()()),2&i){let a,m,g,f,E,v;t.R7$(8),t.Y8G("formGroup",e.alumnoForm),t.R7$(6),t.Dyx(e.alumnos),t.R7$(6),t.vxM(null!=(a=e.alumnoForm.get("nombre"))&&a.invalid&&null!=(a=e.alumnoForm.get("nombre"))&&a.touched?20:-1),t.R7$(5),t.vxM(null!=(m=e.alumnoForm.get("apellido"))&&m.invalid&&null!=(m=e.alumnoForm.get("apellido"))&&m.touched?25:-1),t.R7$(5),t.vxM(null!=(g=e.alumnoForm.get("correo"))&&g.invalid&&null!=(g=e.alumnoForm.get("correo"))&&g.touched?30:-1),t.R7$(5),t.vxM(null!=(f=e.alumnoForm.get("telefono"))&&f.invalid&&null!=(f=e.alumnoForm.get("telefono"))&&f.touched?35:-1),t.R7$(5),t.Dyx(e.grupos),t.R7$(2),t.vxM(null!=(E=e.alumnoForm.get("grupoId"))&&E.invalid&&null!=(E=e.alumnoForm.get("grupoId"))&&E.touched?42:-1),t.R7$(5),t.Dyx(e.tutores),t.R7$(2),t.vxM(null!=(v=e.alumnoForm.get("tutorId"))&&v.invalid&&null!=(v=e.alumnoForm.get("tutorId"))&&v.touched?49:-1),t.R7$(6),t.vxM(e.fotoPreview?55:-1),t.R7$(),t.Y8G("disabled",e.alumnoForm.invalid)}},dependencies:[r.bv,r.Jm,r.QW,r.W9,r.eU,r.iq,r.$w,r.uz,r.he,r.nf,r.Nm,r.Ip,r.IO,r.BC,r.ai,r.Je,r.Gw,u.X1,u.qT,u.BC,u.cb,u.j4,u.JD,h.MD],encapsulation:2})}return l})()},6993:(b,_,s)=>{s.d(_,{p:()=>u});var c=s(2615),h=s(9330);let u=(()=>{class r{constructor(o){this.http=o,this.apiUrl="https://backescolar-production.up.railway.app/alumnos"}crearAlumno(o){return this.http.post(`${this.apiUrl}`,o)}obtenerAlumnos(){return this.http.get(this.apiUrl)}obtenerAlumnoPorId(o){return this.http.get(`${this.apiUrl}/${o}`)}obtenerPorTutor(o){return this.http.get(`${this.apiUrl}/tutor/${o}`)}obtenerPorGrupo(o){return this.http.get(`${this.apiUrl}/grupo/${o}`)}actualizarAlumno(o,p){return this.http.patch(`${this.apiUrl}/${o}`,p)}eliminarAlumno(o){return this.http.delete(`${this.apiUrl}/${o}`)}obtenerPorMaestro(o){return this.http.get(`${this.apiUrl}/maestro/${o}/alumnos`)}static#t=this.\u0275fac=function(p){return new(p||r)(c.KVO(h.Qq))};static#o=this.\u0275prov=c.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()},8816:(b,_,s)=>{s.d(_,{c:()=>u});var c=s(2615),h=s(9330);let u=(()=>{class r{constructor(o){this.http=o,this.apiUrl="https://backescolar-production.up.railway.app/tutores"}crearTutor(o){return this.http.post(this.apiUrl,o)}obtenerTutores(){return this.http.get(this.apiUrl)}editarTutor(o,p){return this.http.patch(`${this.apiUrl}/${o}`,p)}obtenerTutorPorId(o){return this.http.get(`${this.apiUrl}/${o}`)}actualizarTutor(o,p){return this.http.patch(`${this.apiUrl}/${o}`,p)}eliminarTutor(o){return this.http.delete(`${this.apiUrl}/${o}`)}static#t=this.\u0275fac=function(p){return new(p||r)(c.KVO(h.Qq))};static#o=this.\u0275prov=c.jDH({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})()}}]);